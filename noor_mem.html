<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GoFile Uploader | Premium</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6366f1;
      --primary-dark: #4f46e5;
      --secondary: #f0f9ff;
      --success: #10b981;
      --error: #ef4444;
      --warning: #f59e0b;
      --text: #1f2937;
      --light-text: #6b7280;
      --border: #e5e7eb;
      --card-bg: #ffffff;
      --bg-gradient: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      --header-gradient: linear-gradient(90deg, #4f46e5 0%, #7c3aed 100%);
      --btn-gradient: linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%);
      --btn-hover-gradient: linear-gradient(90deg, #4f46e5 0%, #7c3aed 100%);
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: var(--text);
      background: var(--bg-gradient);
      min-height: 100vh;
      padding: 20px;
      position: relative;
      overflow-x: hidden;
    }
    
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 280px;
      background: var(--header-gradient);
      z-index: -1;
      border-radius: 0 0 40px 40px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      margin-bottom: 20px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .logo-icon {
      background: white;
      width: 40px;
      height: 40px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow);
    }
    
    .logo-icon i {
      color: var(--primary);
      font-size: 20px;
    }
    
    .logo-text {
      font-family: 'Montserrat', sans-serif;
      font-weight: 800;
      font-size: 28px;
      color: white;
      letter-spacing: -0.5px;
    }
    
    .logo-text span {
      color: #c7d2fe;
    }
    
    .stats-card {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 15px 25px;
      display: flex;
      gap: 25px;
    }
    
    .stat-item {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .stat-value {
      font-size: 22px;
      font-weight: 700;
      color: white;
    }
    
    .stat-label {
      font-size: 14px;
      color: #e0e7ff;
    }
    
    .main-content {
      display: grid;
      grid-template-columns: 1fr 350px;
      gap: 25px;
      margin-bottom: 40px;
    }
    
    .upload-container {
      background: var(--card-bg);
      border-radius: 24px;
      box-shadow: var(--shadow);
      padding: 30px;
      transition: var(--transition);
    }
    
    .section-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 25px;
      color: var(--text);
      font-size: 22px;
      font-weight: 600;
    }
    
    .section-title i {
      color: var(--primary);
      background: rgba(99, 102, 241, 0.1);
      width: 40px;
      height: 40px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .drop-area {
      border: 2px dashed var(--border);
      border-radius: 18px;
      padding: 50px 30px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      margin-bottom: 25px;
      background: rgba(240, 249, 255, 0.5);
      position: relative;
      overflow: hidden;
    }
    
    .drop-area::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--primary);
      transform: translateX(-100%);
      transition: transform 0.6s ease;
    }
    
    .drop-area.highlight {
      border-color: var(--primary);
      background: rgba(99, 102, 241, 0.05);
    }
    
    .drop-area.highlight::before {
      transform: translateX(0);
    }
    
    .drop-area i {
      font-size: 56px;
      color: var(--primary);
      margin-bottom: 15px;
      opacity: 0.7;
    }
    
    .drop-area h3 {
      font-size: 22px;
      margin-bottom: 10px;
      color: var(--text);
    }
    
    .drop-area p {
      color: var(--light-text);
      margin-bottom: 20px;
    }
    
    .file-input {
      display: none;
    }
    
    .btn {
      background: var(--btn-gradient);
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }
    
    .btn:hover {
      background: var(--btn-hover-gradient);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
    }
    
    .btn:active {
      transform: translateY(0);
    }
    
    .btn-secondary {
      background: white;
      color: var(--primary);
      border: 1px solid var(--border);
      box-shadow: var(--card-shadow);
    }
    
    .btn-secondary:hover {
      background: var(--secondary);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
    }
    
    .preview-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 20px;
      margin-top: 25px;
    }
    
    .file-card {
      background: var(--card-bg);
      border-radius: 16px;
      overflow: hidden;
      position: relative;
      box-shadow: var(--card-shadow);
      transition: var(--transition);
      border: 1px solid var(--border);
    }
    
    .file-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
    }
    
    .file-thumbnail {
      width: 100%;
      height: 140px;
      object-fit: cover;
      display: block;
    }
    
    .file-info {
      padding: 15px;
    }
    
    .file-name {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-bottom: 8px;
      font-weight: 500;
      font-size: 14px;
    }
    
    .file-size {
      color: var(--light-text);
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .progress-container {
      height: 6px;
      background-color: var(--border);
      border-radius: 3px;
      margin-top: 10px;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background: var(--btn-gradient);
      border-radius: 3px;
      width: 0%;
      transition: width 0.6s cubic-bezier(0.22, 0.61, 0.36, 1);
    }
    
    .controls {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin: 25px 0 10px;
      gap: 12px;
    }
    
    .sidebar {
      background: var(--card-bg);
      border-radius: 24px;
      box-shadow: var(--shadow);
      padding: 30px;
      height: fit-content;
      transition: var(--transition);
    }
    
    .results {
      margin-top: 25px;
    }
    
    .result-item {
      display: flex;
      align-items: center;
      padding: 18px;
      background: var(--card-bg);
      border-radius: 16px;
      margin-bottom: 15px;
      box-shadow: var(--card-shadow);
      transition: var(--transition);
      border: 1px solid var(--border);
    }
    
    .result-item:hover {
      transform: translateX(5px);
    }
    
    .result-thumbnail {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 12px;
      margin-right: 18px;
      background: var(--secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary);
      font-size: 24px;
    }
    
    .result-details {
      flex-grow: 1;
    }
    
    .result-name {
      font-weight: 500;
      margin-bottom: 5px;
      font-size: 15px;
    }
    
    .result-url {
      font-size: 13px;
      color: var(--light-text);
      word-break: break-all;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .result-url a {
      color: var(--primary);
      text-decoration: none;
    }
    
    .result-url a:hover {
      text-decoration: underline;
    }
    
    .copy-btn {
      background: rgba(99, 102, 241, 0.1);
      border: none;
      color: var(--primary);
      cursor: pointer;
      font-size: 14px;
      padding: 8px 15px;
      border-radius: 8px;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .copy-btn:hover {
      background: rgba(99, 102, 241, 0.2);
      transform: translateY(-2px);
    }
    
    .status {
      text-align: center;
      padding: 16px;
      margin: 15px 0;
      border-radius: 12px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .status.success {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }
    
    .status.error {
      background: rgba(239, 68, 68, 0.1);
      color: var(--error);
    }
    
    .status.warning {
      background: rgba(245, 158, 11, 0.1);
      color: var(--warning);
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .hidden-textarea {
      position: absolute;
      left: -9999px;
      opacity: 0;
      height: 0;
      width: 0;
      overflow: hidden;
    }
    
    .feature-card {
      background: var(--card-bg);
      border-radius: 18px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: var(--card-shadow);
      border: 1px solid var(--border);
      transition: var(--transition);
    }
    
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
    }
    
    .feature-card h3 {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
      color: var(--text);
    }
    
    .feature-card h3 i {
      color: var(--primary);
      background: rgba(99, 102, 241, 0.1);
      width: 36px;
      height: 36px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .feature-card ul {
      padding-left: 20px;
      color: var(--light-text);
    }
    
    .feature-card li {
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    footer {
      text-align: center;
      padding: 25px 0;
      color: var(--light-text);
      font-size: 14px;
      border-top: 1px solid var(--border);
      margin-top: 40px;
    }
    
    @media (max-width: 900px) {
      .main-content {
        grid-template-columns: 1fr;
      }
      
      .stats-card {
        display: none;
      }
    }
    
    @media (max-width: 600px) {
      .upload-container, .sidebar {
        padding: 20px;
      }
      
      .drop-area {
        padding: 30px 15px;
      }
      
      .preview-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 15px;
      }
      
      .btn {
        padding: 12px 20px;
        font-size: 14px;
      }
      
      .logo-text {
        font-size: 24px;
      }
    }
    
    /* Animation for file upload */
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
      100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
    }
    
    .pulse {
      animation: pulse 1.5s infinite;
    }
    
    /* Floating action button */
    .fab {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: var(--btn-gradient);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
      cursor: pointer;
      transition: var(--transition);
      z-index: 100;
    }
    
    .fab:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 8px 25px rgba(99, 102, 241, 0.5);
    }
    
    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--card-bg);
      color: var(--text);
      padding: 15px 25px;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      display: flex;
      align-items: center;
      gap: 12px;
      z-index: 1000;
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }
    
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
    
    .toast.success {
      border-left: 4px solid var(--success);
    }
    
    .toast.error {
      border-left: 4px solid var(--error);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <div class="logo-icon">
          <i class="fas fa-cloud-upload-alt"></i>
        </div>
        <div class="logo-text">Go<span>File</span></div>
      </div>
      <div class="stats-card">
        <div class="stat-item">
          <div class="stat-value">2.5M+</div>
          <div class="stat-label">Uploads</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">99.9%</div>
          <div class="stat-label">Success Rate</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">24/7</div>
          <div class="stat-label">Service</div>
        </div>
      </div>
    </header>
    
    <div class="main-content">
      <div class="upload-container">
        <div class="section-title">
          <i class="fas fa-cloud-upload-alt"></i>
          <h2>Upload Files</h2>
        </div>
        
        <div id="dropArea" class="drop-area pulse">
          <i class="fas fa-cloud-upload-alt"></i>
          <h3>Drag & Drop Files Here</h3>
          <p>or click the button below to browse your files</p>
          <input type="file" id="fileInput" class="file-input" multiple accept="*/*">
          <button class="btn" onclick="document.getElementById('fileInput').click()">
            <i class="fas fa-folder-open"></i> Select Files
          </button>
          <p class="file-types">Supports: All file types (Max 100MB each)</p>
        </div>
        
        <div id="filePreviews" class="preview-grid"></div>
        
        <div class="controls">
          <button id="uploadBtn" class="btn" onclick="uploadFiles()" disabled>
            <i class="fas fa-upload"></i>
            <span id="uploadBtnText">Upload to GoFile</span>
          </button>
          <button class="btn btn-secondary" onclick="clearFiles()">
            <i class="fas fa-trash-alt"></i> Clear Files
          </button>
        </div>
        
        <div id="status" class="status" style="display: none;"></div>
      </div>
      
      <div class="sidebar">
        <div class="section-title">
          <i class="fas fa-history"></i>
          <h2>Upload Results</h2>
        </div>
        
        <div id="results" class="results" style="display: none;">
          <div id="resultList"></div>
          <div class="controls">
            <button class="btn" onclick="copyAllLinks()">
              <i class="fas fa-copy"></i> Copy All Links
            </button>
          </div>
        </div>
        
        <div class="feature-card">
          <h3><i class="fas fa-crown"></i> Premium Features</h3>
          <ul>
            <li>Unlimited file uploads</li>
            <li>No file size restrictions</li>
            <li>Priority upload processing</li>
            <li>Direct download links</li>
            <li>Advanced file management</li>
          </ul>
        </div>
        
        <div class="feature-card">
          <h3><i class="fas fa-bolt"></i> Why GoFile?</h3>
          <ul>
            <li>Military-grade encryption</li>
            <li>99.9% uptime guarantee</li>
            <li>Lightning-fast CDN delivery</li>
            <li>24/7 dedicated support</li>
            <li>Ad-free experience</li>
          </ul>
        </div>
      </div>
    </div>
    
    <footer>
      <p>Â© 2023 GoFile Uploader Premium | Secure File Hosting Service</p>
    </footer>
  </div>
  
  <div class="fab" onclick="document.getElementById('fileInput').click()">
    <i class="fas fa-plus"></i>
  </div>
  
  <div id="toast" class="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toast-message">Link copied to clipboard!</span>
  </div>
  
  <script>
    // Global variables
    let files = [];
    let uploadResults = [];
    
    // DOM elements
    const dropArea = document.getElementById('dropArea');
    const fileInput = document.getElementById('fileInput');
    const filePreviews = document.getElementById('filePreviews');
    const uploadBtn = document.getElementById('uploadBtn');
    const uploadBtnText = document.getElementById('uploadBtnText');
    const statusDiv = document.getElementById('status');
    const resultsDiv = document.getElementById('results');
    const resultList = document.getElementById('resultList');
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toast-message');
    
    // Event listeners
    dropArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropArea.classList.add('highlight');
    });
    
    dropArea.addEventListener('dragleave', () => {
      dropArea.classList.remove('highlight');
    });
    
    dropArea.addEventListener('drop', (e) => {
      e.preventDefault();
      dropArea.classList.remove('highlight');
      
      if (e.dataTransfer.files.length) {
        handleFiles(e.dataTransfer.files);
      }
    });
    
    fileInput.addEventListener('change', () => {
      if (fileInput.files.length) {
        handleFiles(fileInput.files);
      }
    });
    
    // Handle selected files
    function handleFiles(newFiles) {
      // Convert FileList to array and filter by size
      const validFiles = Array.from(newFiles).filter(file => {
        if (file.size > 100 * 1024 * 1024) {
          showToast(`File "${file.name}" is too large (max 100MB)`, 'error');
          return false;
        }
        return true;
      });
      
      if (validFiles.length === 0) return;
      
      // Add to files array
      files = [...files, ...validFiles];
      
      // Update UI
      updateFilePreviews();
      uploadBtn.disabled = files.length === 0;
      
      showToast(`Added ${validFiles.length} file(s). Ready to upload.`, 'success');
    }
    
    // Update file previews
    function updateFilePreviews() {
      filePreviews.innerHTML = '';
      
      files.forEach((file, index) => {
        const fileCard = document.createElement('div');
        fileCard.className = 'file-card';
        
        let thumbnailSrc = '';
        let iconClass = 'fa-file';
        
        if (file.type.startsWith('image/')) {
          thumbnailSrc = URL.createObjectURL(file);
          iconClass = 'fa-file-image';
        } else {
          // Placeholder icons for different file types
          const fileType = file.type.split('/')[0];
          const fileExt = file.name.split('.').pop().toLowerCase();
          
          if (file.type.includes('pdf')) {
            iconClass = 'fa-file-pdf';
          } else if (file.type.includes('zip') || file.type.includes('compressed') || 
                    ['zip', 'rar', '7z', 'tar', 'gz'].includes(fileExt)) {
            iconClass = 'fa-file-archive';
          } else if (file.type.includes('word') || file.type.includes('document') || 
                    ['doc', 'docx', 'odt'].includes(fileExt)) {
            iconClass = 'fa-file-word';
          } else if (file.type.includes('excel') || file.type.includes('spreadsheet') || 
                    ['xls', 'xlsx', 'csv'].includes(fileExt)) {
            iconClass = 'fa-file-excel';
          } else if (file.type.includes('powerpoint') || file.type.includes('presentation') || 
                    ['ppt', 'pptx'].includes(fileExt)) {
            iconClass = 'fa-file-powerpoint';
          } else if (file.type.includes('text') || ['txt', 'rtf'].includes(fileExt)) {
            iconClass = 'fa-file-alt';
          } else if (file.type.includes('video')) {
            iconClass = 'fa-file-video';
          } else if (file.type.includes('audio')) {
            iconClass = 'fa-file-audio';
          }
        }
        
        if (thumbnailSrc) {
          fileCard.innerHTML = `
            <img src="${thumbnailSrc}" alt="${file.name}" class="file-thumbnail">
            <div class="file-info">
              <div class="file-name" title="${file.name}">${file.name}</div>
              <div class="file-size"><i class="far ${iconClass}"></i> ${formatFileSize(file.size)}</div>
              <div class="progress-container">
                <div class="progress-bar" id="progress-${index}"></div>
              </div>
            </div>
          `;
        } else {
          fileCard.innerHTML = `
            <div class="file-thumbnail" style="display: flex; justify-content: center; align-items: center; background: #f0f9ff;">
              <i class="far ${iconClass}" style="font-size: 48px; color: var(--primary); opacity: 0.7;"></i>
            </div>
            <div class="file-info">
              <div class="file-name" title="${file.name}">${file.name}</div>
              <div class="file-size"><i class="far ${iconClass}"></i> ${formatFileSize(file.size)}</div>
              <div class="progress-container">
                <div class="progress-bar" id="progress-${index}"></div>
              </div>
            </div>
          `;
        }
        
        filePreviews.appendChild(fileCard);
      });
    }
    
    // Format file size
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    // Upload files to GoFile
    async function uploadFiles() {
      if (files.length === 0) {
        showToast('No files to upload', 'error');
        return;
      }

      uploadBtn.disabled = true;
      uploadBtnText.innerHTML = '<span class="loading"></span> Uploading...';
      
      try {
        showStatus('Starting upload...');
        uploadResults = [];

        // Upload files sequentially
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          showStatus(`Uploading ${i+1}/${files.length}: ${file.name}`);
          
          const progressBar = document.getElementById(`progress-${i}`);
          if (progressBar) {
            progressBar.style.width = '0%';
            progressBar.style.background = 'var(--btn-gradient)';
          }

          try {
            const result = await uploadFile(file, (progress) => {
              if (progressBar) {
                progressBar.style.width = `${progress}%`;
              }
            });

            // Handle response
            if (result && result.status === "ok" && result.data) {
              uploadResults.push({
                name: file.name,
                url: result.data.downloadPage || result.data.url,
                thumbnail: file.type.startsWith('image/') ? URL.createObjectURL(file) : null,
                icon: getFileIcon(file)
              });
            } else {
              throw new Error(result?.status || 'Upload failed');
            }
          } catch (error) {
            console.error(`Error uploading ${file.name}:`, error);
            uploadResults.push({
              name: file.name,
              error: error.message || 'Upload failed'
            });
            if (progressBar) {
              progressBar.style.background = 'var(--error)';
            }
          }
        }

        showResults();
        const successCount = uploadResults.filter(r => !r.error).length;
        if (successCount > 0) {
          showToast(`Successfully uploaded ${successCount}/${files.length} files`, 'success');
        } else {
          showToast('All uploads failed', 'error');
        }

      } catch (error) {
        console.error('Upload error:', error);
        showToast(`Upload failed: ${error.message}`, 'error');
      } finally {
        uploadBtnText.innerHTML = '<i class="fas fa-upload"></i> Upload to GoFile';
        uploadBtn.disabled = false;
      }
    }

    // Upload single file
    async function uploadFile(file, progressCallback) {
      return new Promise((resolve, reject) => {
        const formData = new FormData();
        formData.append("file", file);

        const xhr = new XMLHttpRequest();
        
        xhr.upload.addEventListener('progress', (e) => {
          if (e.lengthComputable) {
            progressCallback(Math.round((e.loaded / e.total) * 100));
          }
        });

        xhr.onload = () => {
          try {
            const response = JSON.parse(xhr.responseText);
            if (xhr.status === 200) {
              resolve(response);
            } else {
              reject(new Error(response?.status || `HTTP ${xhr.status}`));
            }
          } catch (error) {
            reject(error);
          }
        };

        xhr.onerror = () => reject(new Error('Network error'));
        xhr.ontimeout = () => reject(new Error('Timeout'));

        xhr.open('POST', 'https://upload.gofile.io/uploadfile', true);
        xhr.timeout = 60000; // 60 seconds timeout
        xhr.send(formData);
      });
    }
    
    // Get file icon class
    function getFileIcon(file) {
      let iconClass = 'fa-file';
      
      if (file.type.startsWith('image/')) {
        iconClass = 'fa-file-image';
      } else {
        const fileExt = file.name.split('.').pop().toLowerCase();
        
        if (file.type.includes('pdf')) {
          iconClass = 'fa-file-pdf';
        } else if (file.type.includes('zip') || file.type.includes('compressed') || 
                  ['zip', 'rar', '7z', 'tar', 'gz'].includes(fileExt)) {
          iconClass = 'fa-file-archive';
        } else if (file.type.includes('word') || file.type.includes('document') || 
                  ['doc', 'docx', 'odt'].includes(fileExt)) {
          iconClass = 'fa-file-word';
        } else if (file.type.includes('excel') || file.type.includes('spreadsheet') || 
                  ['xls', 'xlsx', 'csv'].includes(fileExt)) {
          iconClass = 'fa-file-excel';
        } else if (file.type.includes('powerpoint') || file.type.includes('presentation') || 
                  ['ppt', 'pptx'].includes(fileExt)) {
          iconClass = 'fa-file-powerpoint';
        } else if (file.type.includes('text') || ['txt', 'rtf'].includes(fileExt)) {
          iconClass = 'fa-file-alt';
        } else if (file.type.includes('video')) {
          iconClass = 'fa-file-video';
        } else if (file.type.includes('audio')) {
          iconClass = 'fa-file-audio';
        }
      }
      
      return iconClass;
    }

    // Show upload results
    function showResults() {
      resultsDiv.style.display = 'block';
      resultList.innerHTML = '';
      
      uploadResults.forEach(result => {
        const resultItem = document.createElement('div');
        resultItem.className = 'result-item';

        if (result.error) {
          resultItem.innerHTML = `
            <div class="result-thumbnail" style="color: var(--error);">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="result-details">
              <div class="result-name">${result.name}</div>
              <div class="result-url" style="color: var(--error)">${result.error}</div>
            </div>
          `;
        } else {
          let directLink = result.url;
          if (directLink.includes("/d/")) {
            const id = directLink.split("/d/")[1];
            directLink = `https://store1.gofile.io/download/web/${id}/${encodeURIComponent(result.name)}`;
          }

          const combinedText = `File: ${result.name}
Viewer: ${result.url}
Direct: ${directLink}`;

          resultItem.innerHTML = `
            <div class="result-thumbnail">
              <i class="far ${result.icon}"></i>
            </div>
            <div class="result-details">
              <div class="result-name">${result.name}</div>
              <div class="result-url"><i class="fas fa-link"></i> <a href="${result.url}" target="_blank">Viewer Link</a></div>
              <div class="result-url"><i class="fas fa-download"></i> <a href="${directLink}" target="_blank">Direct Download</a></div>
            </div>
            <button class="copy-btn" onclick="copyToClipboard('${combinedText.replace(/'/g, "\\'")}', this)">
              <i class="fas fa-copy"></i> Copy
            </button>
          `;
        }

        resultList.appendChild(resultItem);
      });
      
      // Scroll to results
      resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Copy to clipboard with fallback
    async function copyToClipboard(text, button = null) {
      try {
        // Try modern clipboard API first
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(text);
        } 
        // Fallback for older browsers/HTTP
        else {
          const textarea = document.createElement('textarea');
          textarea.className = 'hidden-textarea';
          textarea.value = text;
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);
        }
        
        // Visual feedback
        if (button) {
          const originalHTML = button.innerHTML;
          button.innerHTML = '<i class="fas fa-check"></i> Copied!';
          button.style.background = 'rgba(16, 185, 129, 0.2)';
          button.style.color = 'var(--success)';
          setTimeout(() => {
            button.innerHTML = originalHTML;
            button.style.background = '';
            button.style.color = '';
          }, 2000);
        }
        showToast('Link copied to clipboard!', 'success');
      } catch (err) {
        console.error('Copy failed:', err);
        showToast('Failed to copy link', 'error');
      }
    }

    // Copy all links
    async function copyAllLinks() {
      const links = uploadResults
        .filter(r => !r.error)
        .map(r => `${r.name}: ${r.url}`)
        .join('\n\n');
      
      if (!links) {
        showToast('No links to copy', 'error');
        return;
      }
      
      await copyToClipboard(links);
      
      // Visual feedback for all buttons
      document.querySelectorAll('.copy-btn').forEach(btn => {
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
        btn.style.background = 'rgba(16, 185, 129, 0.2)';
        btn.style.color = 'var(--success)';
        setTimeout(() => {
          btn.innerHTML = originalHTML;
          btn.style.background = '';
          btn.style.color = '';
        }, 2000);
      });
    }

    // Clear all files
    function clearFiles() {
      // Revoke object URLs
      files.forEach(file => {
        if (file.type.startsWith('image/')) {
          URL.revokeObjectURL(file);
        }
      });
      
      files = [];
      uploadResults = [];
      filePreviews.innerHTML = '';
      uploadBtn.disabled = true;
      resultsDiv.style.display = 'none';
      statusDiv.style.display = 'none';
      
      showToast('All files cleared', 'success');
    }

    // Show status message
    function showStatus(message, type = '') {
      statusDiv.style.display = 'flex';
      statusDiv.innerHTML = `<i class="fas fa-info-circle"></i> ${message}`;
      statusDiv.className = 'status';
      
      if (type) {
        statusDiv.classList.add(type);
      }
    }
    
    // Show toast notification
    function showToast(message, type = 'success') {
      toast.className = `toast ${type}`;
      toastMessage.textContent = message;
      
      if (type === 'success') {
        toast.innerHTML = `<i class="fas fa-check-circle"></i> <span id="toast-message">${message}</span>`;
      } else if (type === 'error') {
        toast.innerHTML = `<i class="fas fa-exclamation-circle"></i> <span id="toast-message">${message}</span>`;
      }
      
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
  </script>
</body>
</html>
